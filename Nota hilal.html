<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Nota Penjualan 55mm</title>
  <style>
    @media print {
      @page {
        size: 55mm auto;
        margin: 5mm;
      }
    }

    body {
      font-family: monospace;
      width: 55mm;
      margin: 0 auto;
      padding: 0;
      font-size: 10pt;
    }

    h2, h4 {
      text-align: center;
      margin: 0;
    }

    p {
      margin: 4px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 5px;
    }

    th, td {
      padding: 2px 0;
      text-align: left;
      font-size: 9pt;
    }

    tfoot td {
      border-top: 1px dashed #000;
      font-weight: bold;
    }

    .center {
      text-align: center;
    }

    .divider {
      border-top: 1px solid #000;
      margin: 4px 0;
    }

    .print-btn {
      display: none;
    }

    @media screen {
      .print-btn {
        display: block;
        margin-top: 10px;
        text-align: center;
      }
    }
  </style>
</head>
<body>

    <h2>TOKO ABC</h2>
  <h4>Jl. Contoh No.123</h4>
  <div class="center">Telp: 08123456789</div>
  <div class="divider"></div>

  <p id="tanggal"></p>
  <p id="pelanggan"></p>
  <div class="divider"></div>

  <table>
    <thead>
      <tr>
        <th colspan="2">Description</th>
        <th style="text-align:right">Sub Total</th>
      </tr>
    </thead>
    <tbody id="item-list">
      <!-- Diisi lewat JS -->
    </tbody>
    <tfoot>
      <tr>
        <td colspan="2" style="text-align:right">Total</td>
        <td style="text-align:right" id="total"></td>
      </tr>
    </tfoot>
  </table>

  <hr>
  <div class="center">Terima kasih!</div>

  <script>
    const params = new URLSearchParams(window.location.search);

    // Set tanggal & pelanggan
    document.getElementById("tanggal").textContent = "Tanggal: " + (params.get("tanggal") || "-");
    document.getElementById("pelanggan").textContent = "Pelanggan: " + (params.get("pelanggan") || "-");

    // Set total
    document.getElementById("total").textContent = parseInt(params.get("total") || 0).toLocaleString();

    // Loop items
    const itemsRaw = params.get("items");
    const itemList = document.getElementById("item-list");

    if (itemsRaw) {
      const items = itemsRaw.split(",");
      items.forEach(itemStr => {
        const [nama, qty, harga] = itemStr.split("|");
        const subtotal = parseInt(qty) * parseInt(harga);

        // Row 1: Nama Produk + Subtotal
        const row1 = document.createElement("tr");
        row1.innerHTML = `
          <td colspan="2">${nama}</td>
          <td rowspan="2" style="text-align:right">${subtotal.toLocaleString()}</td>
        `;
        itemList.appendChild(row1);

        // Row 2: Qty x Harga
        const row2 = document.createElement("tr");
        row2.innerHTML = `<td colspan="2">${qty} x ${parseInt(harga).toLocaleString()}</td>`;
        itemList.appendChild(row2);
      });
    }
  </script>

</body>
</html>
